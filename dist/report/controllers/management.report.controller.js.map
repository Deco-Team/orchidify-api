{"version":3,"file":"management.report.controller.js","sourceRoot":"/","sources":["report/controllers/management.report.controller.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;AAAA,2CAA0E;AAC1E,6CAA4G;AAG5G,oDAAqD;AACrD,+DAAgE;AAChE,4DAA8G;AAC9G,qEAA0D;AAC1D,+DAAqD;AACrD,8DAAqD;AACrD,2EAAwD;AACxD,oDAAuD;AAOhD,IAAM,0BAA0B,GAAhC,MAAM,0BAA0B;IACrC,YAEmB,aAA6B;QAA7B,kBAAa,GAAb,aAAa,CAAgB;IAC7C,CAAC;IASE,AAAN,KAAK,CAAC,sBAAsB;QAC1B,MAAM,OAAO,GAAG,MAAM,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC;YAChD,IAAI,EAAE;gBACJ,GAAG,EAAE;oBACH,qBAAU,CAAC,SAAS;oBACpB,qBAAU,CAAC,UAAU;oBACrB,qBAAU,CAAC,aAAa;oBACxB,qBAAU,CAAC,cAAc;iBAC1B;aACF;SACF,CAAC,CAAA;QAiBF,OAAO,EAAE,IAAI,EAAE,OAAO,EAAE,CAAA;IAC1B,CAAC;CACF,CAAA;AA1CY,gEAA0B;AAa/B;IAPL,IAAA,sBAAY,EAAC;QACZ,OAAO,EAAE,IAAI,mBAAQ,CAAC,KAAK,kCAAkC;KAC9D,CAAC;IACD,IAAA,uBAAa,GAAE;IACf,IAAA,uBAAa,EAAC,EAAE,IAAI,EAAE,wCAAsB,EAAE,CAAC;IAC/C,IAAA,uBAAK,EAAC,mBAAQ,CAAC,KAAK,CAAC;IACrB,IAAA,YAAG,EAAC,eAAe,CAAC;;;;wEA6BpB;qCAzCU,0BAA0B;IALtC,IAAA,iBAAO,EAAC,QAAQ,CAAC;IACjB,IAAA,uBAAa,GAAE;IACf,IAAA,+BAAqB,EAAC,EAAE,IAAI,EAAE,mBAAa,EAAE,CAAC;IAC9C,IAAA,kBAAS,EAAC,6BAAY,CAAC,YAAY,EAAE,wBAAU,CAAC;IAChD,IAAA,mBAAU,EAAC,YAAY,CAAC;IAGpB,WAAA,IAAA,eAAM,EAAC,+BAAc,CAAC,CAAA;;GAFd,0BAA0B,CA0CtC","sourcesContent":["import { Controller, Get, Inject, Query, UseGuards } from '@nestjs/common'\r\nimport { ApiBadRequestResponse, ApiBearerAuth, ApiOkResponse, ApiOperation, ApiTags } from '@nestjs/swagger'\r\nimport * as _ from 'lodash'\r\n\r\nimport { ErrorResponse } from '@common/contracts/dto'\r\nimport { IReportService } from '@report/services/report.service'\r\nimport { QueryReportDto, ReportDetailDataResponse, ReportListDataResponse } from '@report/dto/view-report.dto'\r\nimport { JwtAuthGuard } from '@auth/guards/jwt-auth.guard'\r\nimport { RolesGuard } from '@auth/guards/roles.guard'\r\nimport { UserRole } from '@common/contracts/constant'\r\nimport { Roles } from '@auth/decorators/roles.decorator'\r\nimport { ReportType } from '@report/contracts/constant'\r\n\r\n@ApiTags('Report')\r\n@ApiBearerAuth()\r\n@ApiBadRequestResponse({ type: ErrorResponse })\r\n@UseGuards(JwtAuthGuard.ACCESS_TOKEN, RolesGuard)\r\n@Controller('management')\r\nexport class ManagementReportController {\r\n  constructor(\r\n    @Inject(IReportService)\r\n    private readonly reportService: IReportService\r\n  ) {}\r\n\r\n  @ApiOperation({\r\n    summary: `[${UserRole.STAFF}] View Report Data Total Summary`\r\n  })\r\n  @ApiBearerAuth()\r\n  @ApiOkResponse({ type: ReportListDataResponse })\r\n  @Roles(UserRole.STAFF)\r\n  @Get('total-summary')\r\n  async viewReportTotalSummary() {\r\n    const reports = await this.reportService.findMany({\r\n      type: {\r\n        $in: [\r\n          ReportType.CourseSum,\r\n          ReportType.LearnerSum,\r\n          ReportType.InstructorSum,\r\n          ReportType.CourseComboSum\r\n        ]\r\n      }\r\n    })\r\n    // const a = [\r\n    //   {\r\n    //     learner: {\r\n    //       quantity: 1000\r\n    //     },\r\n    //     instructor: {\r\n    //       quantity: 1000\r\n    //     }\r\n    //   }\r\n    // ]\r\n    // const b = [\r\n    //   {\r\n    //     status: '',\r\n    //     quantity: 1000\r\n    //   }\r\n    // ]\r\n    return { docs: reports }\r\n  }\r\n}\r\n"]}
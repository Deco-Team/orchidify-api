{"version":3,"file":"instructor.controller.js","sourceRoot":"/","sources":["instructor/controllers/instructor.controller.ts"],"names":[],"mappings":"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","sourcesContent":["import { Controller, Get, Req, UseGuards, Inject, Put, Body } from '@nestjs/common'\r\nimport { ApiBadRequestResponse, ApiBearerAuth, ApiOkResponse, ApiOperation, ApiTags } from '@nestjs/swagger'\r\nimport * as _ from 'lodash'\r\n\r\nimport { ErrorResponse, SuccessDataResponse, SuccessResponse } from '@common/contracts/dto'\r\nimport { Roles } from '@auth/decorators/roles.decorator'\r\nimport { UserRole } from '@common/contracts/constant'\r\nimport { JwtAuthGuard } from '@auth/guards/jwt-auth.guard'\r\nimport { RolesGuard } from '@auth/guards/roles.guard'\r\nimport { AppException } from '@common/exceptions/app.exception'\r\nimport { Errors } from '@common/contracts/error'\r\nimport { ApiErrorResponse } from '@common/decorators/api-response.decorator'\r\nimport { IInstructorService } from '@instructor/services/instructor.service'\r\nimport {\r\n  InstructorCertificationsDataResponse,\r\n  InstructorProfileDataResponse\r\n} from '@instructor/dto/view-instructor.dto'\r\nimport { INSTRUCTOR_PROFILE_PROJECTION } from '@instructor/contracts/constant'\r\nimport { UpdateInstructorProfileDto } from '@instructor/dto/update-instructor-profile.dto'\r\n\r\n@ApiTags('Instructor')\r\n@ApiBearerAuth()\r\n@ApiBadRequestResponse({ type: ErrorResponse })\r\n@Roles(UserRole.INSTRUCTOR)\r\n@UseGuards(JwtAuthGuard.ACCESS_TOKEN, RolesGuard)\r\n@Controller()\r\nexport class InstructorController {\r\n  constructor(\r\n    @Inject(IInstructorService)\r\n    private readonly instructorService: IInstructorService\r\n  ) {}\r\n\r\n  @ApiOperation({\r\n    summary: 'View instructor profile'\r\n  })\r\n  @Get('profile')\r\n  @ApiOkResponse({ type: InstructorProfileDataResponse })\r\n  @ApiErrorResponse([Errors.INSTRUCTOR_NOT_FOUND])\r\n  async viewProfile(@Req() req) {\r\n    const { _id } = _.get(req, 'user')\r\n    const instructor = await this.instructorService.findById(_id, INSTRUCTOR_PROFILE_PROJECTION)\r\n\r\n    if (!instructor) throw new AppException(Errors.INSTRUCTOR_NOT_FOUND)\r\n    return instructor\r\n  }\r\n\r\n  @ApiOperation({\r\n    summary: 'View instructor certifications'\r\n  })\r\n  @Get('certifications')\r\n  @ApiOkResponse({ type: InstructorCertificationsDataResponse })\r\n  @ApiErrorResponse([Errors.INSTRUCTOR_NOT_FOUND])\r\n  async viewCertifications(@Req() req) {\r\n    const { _id } = _.get(req, 'user')\r\n    const instructor = await this.instructorService.findById(_id, 'certificates')\r\n    if (!instructor) throw new AppException(Errors.INSTRUCTOR_NOT_FOUND)\r\n\r\n    return { docs: _.get(instructor, 'certificates', []) }\r\n  }\r\n\r\n  @ApiOperation({\r\n    summary: 'Update instructor profile'\r\n  })\r\n  @Put('profile')\r\n  @ApiOkResponse({ type: SuccessDataResponse })\r\n  @ApiErrorResponse([Errors.INSTRUCTOR_NOT_FOUND])\r\n  async updateProfile(@Req() req, @Body() updateInstructorProfileDto: UpdateInstructorProfileDto) {\r\n    const { _id } = _.get(req, 'user')\r\n    const instructor = await this.instructorService.update({ _id }, updateInstructorProfileDto)\r\n\r\n    if (!instructor) throw new AppException(Errors.INSTRUCTOR_NOT_FOUND)\r\n    return new SuccessResponse(true)\r\n  }\r\n}\r\n"]}
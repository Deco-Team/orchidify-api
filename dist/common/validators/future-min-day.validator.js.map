{"version":3,"file":"future-min-day.validator.js","sourceRoot":"/","sources":["common/validators/future-min-day.validator.ts"],"names":[],"mappings":";;;;;;;;;AAAA,2CAAgD;AAChD,0CAAyC;AACzC,qDAMwB;AACxB,yCAAyC;AAGzC,IAAM,qBAAqB,GAA3B,MAAM,qBAAqB;IACzB,QAAQ,CAAC,KAAW,EAAE,mBAAyC;QAC7D,MAAM,GAAG,GAAG,MAAM,EAAE,CAAC,EAAE,CAAC,oBAAW,CAAC,CAAA;QACpC,MAAM,UAAU,GAAG,MAAM,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,oBAAW,CAAC,CAAA;QAChD,MAAM,GAAG,GAAG,mBAAmB,CAAC,WAAW,CAAC,CAAC,CAAC,IAAI,CAAC,CAAA;QAEnD,OAAO,UAAU,CAAC,QAAQ,CAAC,GAAG,EAAE,KAAK,CAAC,CAAC,aAAa,CAAC,GAAG,EAAE,KAAK,CAAC,CAAA;IAClE,CAAC;IAED,cAAc,CAAC,IAA0B;QACvC,MAAM,GAAG,GAAG,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC,IAAI,CAAC,CAAA;QACpC,OAAO,sBAAsB,GAAG,gBAAgB,CAAA;IAClD,CAAC;CACF,CAAA;AAbK,qBAAqB;IAD1B,IAAA,qCAAmB,EAAC,EAAE,IAAI,EAAE,cAAc,EAAE,CAAC;GACxC,qBAAqB,CAa1B;AAED,SAAgB,YAAY,CAAC,QAAgB,CAAC;IAC5C,OAAO,IAAA,wBAAe,EAAC,IAAA,8BAAY,EAAC,EAAE,MAAM,EAAE,IAAI,EAAE,CAAC,EAAE,IAAA,0BAAQ,EAAC,qBAAqB,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC,CAAA;AAClG,CAAC;AAFD,oCAEC","sourcesContent":["import { applyDecorators } from '@nestjs/common'\r\nimport * as moment from 'moment-timezone'\r\nimport {\r\n  ValidatorConstraint,\r\n  ValidatorConstraintInterface,\r\n  ValidationArguments,\r\n  Validate,\r\n  IsDateString\r\n} from 'class-validator'\r\nimport { VN_TIMEZONE } from '@src/config'\r\n\r\n@ValidatorConstraint({ name: 'futureMinDay' })\r\nclass FutureMinDayValidator implements ValidatorConstraintInterface {\r\n  validate(value: Date, validationArguments?: ValidationArguments): boolean {\r\n    const now = moment().tz(VN_TIMEZONE)\r\n    const dateMoment = moment(value).tz(VN_TIMEZONE)\r\n    const day = validationArguments.constraints[0] ?? 1\r\n\r\n    return dateMoment.subtract(day, 'day').isSameOrAfter(now, 'day')\r\n  }\r\n\r\n  defaultMessage(args?: ValidationArguments) {\r\n    const day = args.constraints[0] ?? 1\r\n    return `Date must be after ${day} days from now`\r\n  }\r\n}\r\n\r\nexport function FutureMinDay(month: number = 1): PropertyDecorator {\r\n  return applyDecorators(IsDateString({ strict: true }), Validate(FutureMinDayValidator, [month]))\r\n}\r\n"]}
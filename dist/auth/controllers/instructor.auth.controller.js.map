{"version":3,"file":"instructor.auth.controller.js","sourceRoot":"/","sources":["auth/controllers/instructor.auth.controller.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;AAAA,2CAA+E;AAC/E,6CAAmG;AACnG,2DAA0D;AAC1D,gDAA8C;AAC9C,oDAA0E;AAC1E,gDAAwE;AACxE,8DAAqD;AACrD,6DAA0D;AAC1D,4EAAyE;AACzE,2FAA4E;AAC5E,wDAAgD;AAKzC,IAAM,wBAAwB,GAA9B,MAAM,wBAAwB;IACnC,YAEmB,WAAyB;QAAzB,gBAAW,GAAX,WAAW,CAAc;IACzC,CAAC;IAKJ,KAAK,CAAS,QAAkB;QAC9B,OAAO,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,QAAQ,EAAE,mBAAQ,CAAC,UAAU,CAAC,CAAA;IAC9D,CAAC;IAIK,AAAN,KAAK,CAAC,MAAM,CAAS,eAAgC;QACnD,OAAO,MAAM,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,eAAe,CAAC,CAAA;IACvD,CAAC;IAOD,YAAY,CAAQ,GAAG;QACrB,OAAO,IAAI,CAAC,WAAW,CAAC,YAAY,CAAC,GAAG,CAAC,IAAI,EAAE,GAAG,EAAE,GAAG,CAAC,IAAI,EAAE,IAAI,EAAE,GAAG,CAAC,IAAI,EAAE,YAAY,CAAC,CAAA;IAC7F,CAAC;IAKK,AAAN,KAAK,CAAC,QAAQ,CAAS,qBAA4C;QACjE,OAAO,MAAM,IAAI,CAAC,WAAW,CAAC,oBAAoB,CAAC,qBAAqB,CAAC,CAAA;IAC3E,CAAC;CACF,CAAA;AAlCY,4DAAwB;AASnC;IAHC,IAAA,aAAI,EAAC,OAAO,CAAC;IACb,IAAA,4BAAkB,EAAC,EAAE,IAAI,EAAE,6BAAiB,EAAE,CAAC;IAC/C,IAAA,yCAAgB,EAAC,CAAC,cAAM,CAAC,uBAAuB,EAAE,cAAM,CAAC,gBAAgB,CAAC,CAAC;IACrE,WAAA,IAAA,aAAI,GAAE,CAAA;;qCAAW,oBAAQ;;qDAE/B;AAIK;IAFL,IAAA,aAAI,EAAC,QAAQ,CAAC;IACd,IAAA,4BAAkB,EAAC,EAAE,IAAI,EAAE,yBAAmB,EAAE,CAAC;IACpC,WAAA,IAAA,aAAI,GAAE,CAAA;;qCAAkB,2BAAe;;sDAEpD;AAOD;IALC,IAAA,uBAAa,GAAE;IACf,IAAA,kBAAS,EAAC,6BAAY,CAAC,aAAa,CAAC;IACrC,IAAA,aAAI,EAAC,SAAS,CAAC;IACf,IAAA,4BAAkB,EAAC,EAAE,IAAI,EAAE,6BAAiB,EAAE,CAAC;IAC/C,IAAA,yCAAgB,EAAC,CAAC,cAAM,CAAC,qBAAqB,CAAC,CAAC;IACnC,WAAA,IAAA,YAAG,GAAE,CAAA;;;;4DAElB;AAKK;IAHL,IAAA,aAAI,EAAC,UAAU,CAAC;IAChB,IAAA,4BAAkB,EAAC,EAAE,IAAI,EAAE,yBAAmB,EAAE,CAAC;IACjD,IAAA,yCAAgB,EAAC,CAAC,cAAM,CAAC,mBAAmB,EAAE,cAAM,CAAC,0CAA0C,CAAC,CAAC;IAClF,WAAA,IAAA,aAAI,GAAE,CAAA;;qCAAwB,+CAAqB;;wDAElE;mCAjCU,wBAAwB;IAHpC,IAAA,iBAAO,EAAC,mBAAmB,CAAC;IAC5B,IAAA,mBAAU,EAAC,YAAY,CAAC;IACxB,IAAA,+BAAqB,EAAC,EAAE,IAAI,EAAE,mBAAa,EAAE,CAAC;IAG1C,WAAA,IAAA,eAAM,EAAC,2BAAY,CAAC,CAAA;;GAFZ,wBAAwB,CAkCpC","sourcesContent":["import { Body, Controller, Inject, Post, Req, UseGuards } from '@nestjs/common'\r\nimport { ApiBadRequestResponse, ApiBearerAuth, ApiCreatedResponse, ApiTags } from '@nestjs/swagger'\r\nimport { IAuthService } from '@auth/services/auth.service'\r\nimport { LoginDto } from '@auth/dto/login.dto'\r\nimport { ErrorResponse, SuccessDataResponse } from '@common/contracts/dto'\r\nimport { RefreshTokenDto, TokenDataResponse } from '@auth/dto/token.dto'\r\nimport { UserRole } from '@common/contracts/constant'\r\nimport { JwtAuthGuard } from '@auth/guards/jwt-auth.guard'\r\nimport { InstructorRegisterDto } from '@auth/dto/instructor-register.dto'\r\nimport { ApiErrorResponse } from '@common/decorators/api-response.decorator'\r\nimport { Errors } from '@common/contracts/error'\r\n\r\n@ApiTags('Auth - Instructor')\r\n@Controller('instructor')\r\n@ApiBadRequestResponse({ type: ErrorResponse })\r\nexport class InstructorAuthController {\r\n  constructor(\r\n    @Inject(IAuthService)\r\n    private readonly authService: IAuthService\r\n  ) {}\r\n\r\n  @Post('login')\r\n  @ApiCreatedResponse({ type: TokenDataResponse })\r\n  @ApiErrorResponse([Errors.WRONG_EMAIL_OR_PASSWORD, Errors.INACTIVE_ACCOUNT])\r\n  login(@Body() loginDto: LoginDto) {\r\n    return this.authService.login(loginDto, UserRole.INSTRUCTOR)\r\n  }\r\n\r\n  @Post('logout')\r\n  @ApiCreatedResponse({ type: SuccessDataResponse })\r\n  async logout(@Body() refreshTokenDto: RefreshTokenDto) {\r\n    return await this.authService.logout(refreshTokenDto)\r\n  }\r\n\r\n  @ApiBearerAuth()\r\n  @UseGuards(JwtAuthGuard.REFRESH_TOKEN)\r\n  @Post('refresh')\r\n  @ApiCreatedResponse({ type: TokenDataResponse })\r\n  @ApiErrorResponse([Errors.REFRESH_TOKEN_INVALID])\r\n  refreshToken(@Req() req) {\r\n    return this.authService.refreshToken(req.user?._id, req.user?.role, req.user?.refreshToken)\r\n  }\r\n\r\n  @Post('register')\r\n  @ApiCreatedResponse({ type: SuccessDataResponse })\r\n  @ApiErrorResponse([Errors.EMAIL_ALREADY_EXIST, Errors.INSTRUCTOR_HAS_IN_PROGRESSING_APPLICATIONS])\r\n  async register(@Body() instructorRegisterDto: InstructorRegisterDto) {\r\n    return await this.authService.registerByInstructor(instructorRegisterDto)\r\n  }\r\n}\r\n"]}
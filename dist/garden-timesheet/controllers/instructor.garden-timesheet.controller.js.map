{"version":3,"file":"instructor.garden-timesheet.controller.js","sourceRoot":"/","sources":["garden-timesheet/controllers/instructor.garden-timesheet.controller.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;AAAA,2CAAsF;AACtF,6CAA4G;AAC5G,4BAA2B;AAC3B,oDAAqD;AACrD,2EAAwD;AACxD,8DAAqD;AACrD,qEAA0D;AAC1D,+DAAqD;AACrD,mFAA6F;AAC7F,oFAG0D;AAC1D,sFAG2D;AAC3D,wDAAgD;AAChD,2FAA4E;AAC5E,yEAA+D;AAC/D,8CAA4D;AAQrD,IAAM,mCAAmC,GAAzC,MAAM,mCAAmC;IAC9C,YAEmB,sBAA+C;QAA/C,2BAAsB,GAAtB,sBAAsB,CAAyB;IAC/D,CAAC;IAQE,AAAN,KAAK,CAAC,iBAAiB,CAAQ,GAAG,EAAW,qBAA4C;QACvF,MAAM,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC,GAAG,CAAC,GAAG,EAAE,MAAM,CAAC,CAAA;QAClC,qBAAqB,CAAC,YAAY,GAAG,GAAG,CAAA;QACxC,MAAM,MAAM,GAAG,MAAM,IAAI,CAAC,sBAAsB,CAAC,iBAAiB,CAAC,qBAAqB,CAAC,CAAA;QACzF,OAAO,MAAM,CAAA;IACf,CAAC;IAOK,AAAN,KAAK,CAAC,qBAAqB,CAAQ,GAAG,EAAW,yBAAoD;QACnG,MAAM,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC,GAAG,CAAC,GAAG,EAAE,MAAM,CAAC,CAAA;QAClC,yBAAyB,CAAC,YAAY,GAAG,GAAG,CAAA;QAC5C,MAAM,IAAI,GAAG,MAAM,IAAI,CAAC,sBAAsB,CAAC,qBAAqB,CAAC,yBAAyB,CAAC,CAAA;QAC/F,OAAO,EAAE,IAAI,EAAE,CAAA;IACjB,CAAC;IAQK,AAAN,KAAK,CAAC,aAAa,CAAQ,GAAG,EAAmB,MAAc;QAC7D,MAAM,EAAE,GAAG,EAAE,YAAY,EAAE,GAAG,CAAC,CAAC,GAAG,CAAC,GAAG,EAAE,MAAM,CAAC,CAAA;QAChD,MAAM,IAAI,GAAG,MAAM,IAAI,CAAC,sBAAsB,CAAC,UAAU,CAAC,EAAE,MAAM,EAAE,YAAY,EAAE,CAAC,CAAA;QAEnF,IAAI,CAAC,IAAI;YAAE,MAAM,IAAI,4BAAY,CAAC,cAAM,CAAC,cAAc,CAAC,CAAA;QACxD,OAAO,IAAI,CAAA;IACb,CAAC;CACF,CAAA;AA5CY,kFAAmC;AAYxC;IANL,IAAA,sBAAY,EAAC;QACZ,OAAO,EAAE,uDAAuD;KACjE,CAAC;IACD,IAAA,uBAAa,EAAC,EAAE,IAAI,EAAE,4DAA6B,EAAE,CAAC;IACtD,IAAA,yCAAgB,EAAC,CAAC,cAAM,CAAC,yBAAyB,CAAC,CAAC;IACpD,IAAA,YAAG,EAAC,gBAAgB,CAAC;IACG,WAAA,IAAA,YAAG,GAAE,CAAA;IAAO,WAAA,IAAA,cAAK,GAAE,CAAA;;6CAAwB,oDAAqB;;4EAKxF;AAOK;IALL,IAAA,sBAAY,EAAC;QACZ,OAAO,EAAE,8BAA8B;KACxC,CAAC;IACD,IAAA,uBAAa,EAAC,EAAE,IAAI,EAAE,mEAAqC,EAAE,CAAC;IAC9D,IAAA,YAAG,EAAC,oBAAoB,CAAC;IACG,WAAA,IAAA,YAAG,GAAE,CAAA;IAAO,WAAA,IAAA,cAAK,GAAE,CAAA;;6CAA4B,uDAAyB;;gFAKpG;AAQK;IANL,IAAA,sBAAY,EAAC;QACZ,OAAO,EAAE,kBAAkB;KAC5B,CAAC;IACD,IAAA,uBAAa,EAAC,EAAE,IAAI,EAAE,sBAAW,EAAE,CAAC;IACpC,IAAA,yCAAgB,EAAC,CAAC,cAAM,CAAC,cAAc,CAAC,CAAC;IACzC,IAAA,YAAG,EAAC,6BAA6B,CAAC;IACd,WAAA,IAAA,YAAG,GAAE,CAAA;IAAO,WAAA,IAAA,cAAK,EAAC,QAAQ,CAAC,CAAA;;;;wEAM/C;8CA3CU,mCAAmC;IAN/C,IAAA,iBAAO,EAAC,8BAA8B,CAAC;IACvC,IAAA,uBAAa,GAAE;IACf,IAAA,+BAAqB,EAAC,EAAE,IAAI,EAAE,mBAAa,EAAE,CAAC;IAC9C,IAAA,kBAAS,EAAC,6BAAY,CAAC,YAAY,EAAE,wBAAU,CAAC;IAChD,IAAA,uBAAK,EAAC,mBAAQ,CAAC,UAAU,CAAC;IAC1B,IAAA,mBAAU,EAAC,YAAY,CAAC;IAGpB,WAAA,IAAA,eAAM,EAAC,kDAAuB,CAAC,CAAA;;GAFvB,mCAAmC,CA4C/C","sourcesContent":["import { Controller, Get, UseGuards, Inject, Query, Req, Param } from '@nestjs/common'\r\nimport { ApiBadRequestResponse, ApiBearerAuth, ApiOkResponse, ApiOperation, ApiTags } from '@nestjs/swagger'\r\nimport * as _ from 'lodash'\r\nimport { ErrorResponse } from '@common/contracts/dto'\r\nimport { Roles } from '@auth/decorators/roles.decorator'\r\nimport { UserRole } from '@common/contracts/constant'\r\nimport { JwtAuthGuard } from '@auth/guards/jwt-auth.guard'\r\nimport { RolesGuard } from '@auth/guards/roles.guard'\r\nimport { IGardenTimesheetService } from '@garden-timesheet/services/garden-timesheet.service'\r\nimport {\r\n  QueryTeachingTimesheetDto,\r\n  ViewTeachingTimesheetListDataResponse\r\n} from '@garden-timesheet/dto/view-teaching-timesheet.dto'\r\nimport {\r\n  QueryAvailableTimeDto,\r\n  ViewAvailableTimeDataResponse\r\n} from '@garden-timesheet/dto/view-available-timesheet.dto'\r\nimport { Errors } from '@common/contracts/error'\r\nimport { ApiErrorResponse } from '@common/decorators/api-response.decorator'\r\nimport { AppException } from '@common/exceptions/app.exception'\r\nimport { ViewSlotDto } from '@garden-timesheet/dto/slot.dto'\r\n\r\n@ApiTags('GardenTimesheet - Instructor')\r\n@ApiBearerAuth()\r\n@ApiBadRequestResponse({ type: ErrorResponse })\r\n@UseGuards(JwtAuthGuard.ACCESS_TOKEN, RolesGuard)\r\n@Roles(UserRole.INSTRUCTOR)\r\n@Controller('instructor')\r\nexport class InstructorGardenTimesheetController {\r\n  constructor(\r\n    @Inject(IGardenTimesheetService)\r\n    private readonly gardenTimesheetService: IGardenTimesheetService\r\n  ) {}\r\n\r\n  @ApiOperation({\r\n    summary: `View Available Time (SlotNumbers) of Garden Timesheet`\r\n  })\r\n  @ApiOkResponse({ type: ViewAvailableTimeDataResponse })\r\n  @ApiErrorResponse([Errors.WEEKDAYS_OF_CLASS_INVALID])\r\n  @Get('available-time')\r\n  async viewAvailableTime(@Req() req, @Query() queryAvailableTimeDto: QueryAvailableTimeDto) {\r\n    const { _id } = _.get(req, 'user')\r\n    queryAvailableTimeDto.instructorId = _id\r\n    const result = await this.gardenTimesheetService.viewAvailableTime(queryAvailableTimeDto)\r\n    return result\r\n  }\r\n\r\n  @ApiOperation({\r\n    summary: `View Teaching Timesheet List`\r\n  })\r\n  @ApiOkResponse({ type: ViewTeachingTimesheetListDataResponse })\r\n  @Get('teaching-timesheet')\r\n  async viewTeachingTimesheet(@Req() req, @Query() queryTeachingTimesheetDto: QueryTeachingTimesheetDto) {\r\n    const { _id } = _.get(req, 'user')\r\n    queryTeachingTimesheetDto.instructorId = _id\r\n    const docs = await this.gardenTimesheetService.viewTeachingTimesheet(queryTeachingTimesheetDto)\r\n    return { docs }\r\n  }\r\n\r\n  @ApiOperation({\r\n    summary: `View Slot Detail`\r\n  })\r\n  @ApiOkResponse({ type: ViewSlotDto })\r\n  @ApiErrorResponse([Errors.SLOT_NOT_FOUND])\r\n  @Get('slots/:slotId([0-9a-f]{24})')\r\n  async getSlotDetail(@Req() req, @Param('slotId') slotId: string) {\r\n    const { _id: instructorId } = _.get(req, 'user')\r\n    const slot = await this.gardenTimesheetService.findSlotBy({ slotId, instructorId })\r\n\r\n    if (!slot) throw new AppException(Errors.SLOT_NOT_FOUND)\r\n    return slot\r\n  }\r\n}\r\n"]}
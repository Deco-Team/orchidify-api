{"version":3,"file":"transaction.schema.js","sourceRoot":"/","sources":["transaction/schemas/transaction.schema.ts"],"names":[],"mappings":"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","sourcesContent":["import { Prop, Schema, SchemaFactory } from '@nestjs/mongoose'\r\nimport { HydratedDocument, Types } from 'mongoose'\r\nimport * as paginate from 'mongoose-paginate-v2'\r\nimport { Transform } from 'class-transformer'\r\nimport { TransactionStatus, UserRole } from '@common/contracts/constant'\r\nimport { PaymentMethod, TransactionType } from '@src/transaction/contracts/constant'\r\n\r\nexport class TransactionAccount {\r\n  @Prop({ type: Types.ObjectId, required: true })\r\n  userId: Types.ObjectId\r\n\r\n  @Prop({ type: String, enum: UserRole, required: true })\r\n  userRole: UserRole\r\n}\r\n\r\nexport class Payment {\r\n  @Prop({ type: String, required: true })\r\n  id: string\r\n\r\n  @Prop({ type: String, required: true })\r\n  code: string\r\n\r\n  @Prop({ type: Date, required: true })\r\n  createdAt: Date\r\n\r\n  @Prop({ type: String, required: true })\r\n  status: string\r\n\r\n  @Prop({\r\n    type: [Payment]\r\n  })\r\n  histories: Payment[]\r\n}\r\n\r\nexport class Payout {\r\n  @Prop({ type: String, required: true })\r\n  id: string\r\n\r\n  @Prop({ type: String, required: true })\r\n  code: string\r\n\r\n  @Prop({ type: Date, required: true })\r\n  createdAt: Date\r\n\r\n  @Prop({ type: String, required: true })\r\n  status: string\r\n\r\n  @Prop({\r\n    type: [Payout]\r\n  })\r\n  histories: Payout[]\r\n}\r\n\r\nexport type TransactionDocument = HydratedDocument<Transaction>\r\n\r\n@Schema({\r\n  collection: 'transactions',\r\n  timestamps: true,\r\n  toJSON: {\r\n    transform(doc, ret) {\r\n      delete ret.__v\r\n    }\r\n  }\r\n})\r\nexport class Transaction {\r\n  constructor(id?: string) {\r\n    this._id = id\r\n  }\r\n  @Transform(({ value }) => value?.toString())\r\n  _id: string\r\n\r\n  @Prop({ enum: TransactionType, required: true })\r\n  type: TransactionType\r\n\r\n  @Prop({ enum: PaymentMethod })\r\n  paymentMethod: PaymentMethod\r\n\r\n  @Prop({ type: Number, required: true })\r\n  amount: number\r\n\r\n  @Prop({ type: TransactionAccount })\r\n  debitAccount: TransactionAccount\r\n\r\n  @Prop({ type: TransactionAccount })\r\n  creditAccount: TransactionAccount\r\n\r\n  @Prop({ type: String })\r\n  description: string\r\n\r\n  @Prop({ enum: TransactionStatus, required: true })\r\n  status: TransactionStatus\r\n\r\n  @Prop({ type: Payment })\r\n  payment: Payment\r\n\r\n  @Prop({ type: Payout })\r\n  payout: Payout\r\n}\r\n\r\nexport const TransactionSchema = SchemaFactory.createForClass(Transaction)\r\n\r\nTransactionSchema.plugin(paginate)\r\n"]}